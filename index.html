<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Entrevistas - Varejo</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>

<body>
    <div class="container">
        <header>
            <h1>ğŸ“‹ Sistema de Entrevistas</h1>
            <p class="subtitle">AvaliaÃ§Ã£o de candidatos</p>
            <button id="toggleDarkMode" class="btn-theme-toggle" title="Alternar Modo Escuro">
                ğŸŒ™
            </button>
        </header>

        <div class="tabs">
            <button class="tab-btn active" data-tab="entrevista">ğŸ¯ Nova Entrevista</button>
            <button class="tab-btn" data-tab="painel-dia">ğŸ“… Painel do Dia</button>
            <button class="tab-btn" data-tab="agenda">ğŸ“… Agenda</button>
            <button class="tab-btn" data-tab="historico">ğŸ“Š HistÃ³rico</button>
            <button class="tab-btn" data-tab="relatorio">ğŸ“„ RelatÃ³rio PDF</button>
            <button class="tab-btn" data-tab="estatisticas">ğŸ“ˆ EstatÃ­sticas</button>
            <button class="tab-btn" data-tab="configuracoes">âš™ï¸ ConfiguraÃ§Ãµes</button>
        </div>

        <!-- ABA: NOVA ENTREVISTA -->
        <div class="tab-content active" id="tab-entrevista">
            <div class="app-container">
                <div class="card">
                    <h2>ğŸ‘¤ InformaÃ§Ãµes da Entrevista</h2>
                    <form id="formEntrevista">
                        <div class="form-group">
                            <label for="candidatoNome">Nome do Candidato *</label>
                            <input type="text" id="candidatoNome" required placeholder="Nome completo do candidato">
                        </div>

                        <div class="form-group">
                            <label for="cargo">Selecione o Cargo *</label>
                            <select id="cargo" required>
                                <option value="">Escolha um cargo...</option>
                                <!-- Cargos carregados via JavaScript -->
                            </select>
                        </div>

                        <div id="cargoInfo" class="cargo-info hidden">
                            <div class="cargo-info-header">
                                <h3><span id="cargoNomeSelecionado"></span></h3>
                                <div class="cargo-detalhes">
                                    <span>ğŸ“ <span id="totalPerguntas">0</span> perguntas</span>
                                    <span>â±ï¸ <span id="cargoDuracao"></span></span>
                                </div>
                            </div>

                            <div class="cargo-script">
                                <div class="script-item"><strong>ğŸ’° SalÃ¡rio:</strong> <span id="cargoSalario"></span>
                                </div>
                                <div class="script-item"><strong>ğŸ BenefÃ­cios:</strong> <span
                                        id="cargoBeneficios"></span></div>
                                <div class="script-item"><strong>â° HorÃ¡rio:</strong> <span id="cargoHorario"></span>
                                </div>
                            </div>

                            <button type="button" class="btn-secondary btn-small" onclick="alterarCargo()">
                                Alterar Cargo
                            </button>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="dataEntrevista">Data *</label>
                                <input type="date" id="dataEntrevista" required>
                            </div>
                            <div class="form-group">
                                <label for="horaEntrevista">Hora *</label>
                                <input type="time" id="horaEntrevista" required>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="vagaInhire">Nome da Vaga no InHire</label>
                            <input type="text" id="vagaInhire" placeholder="Ex: Gerente de Loja - Rio de Janeiro">
                        </div>

                        <div class="form-group">
                            <label for="entrevistador">Entrevistador *</label>
                            <input type="text" id="entrevistador" required placeholder="Seu nome" value="Rebeca">
                        </div>

                        <div class="form-group">
                            <label for="localEntrevista">Local da Entrevista</label>
                            <select id="localEntrevista">
                                <option value="">Selecione...</option>
                                <option value="presencial">Presencial</option>
                                <option value="online">Online</option>
                            </select>
                        </div>

                        <div class="acoes-agendamento">
                            <button type="button" class="btn btn-google" onclick="agendarGoogleCalendar()">
                                ğŸ“… Agendar no Google
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="salvarAgendamento()">
                                ğŸ’¾ Salvar na Agenda
                            </button>
                        </div>

                        <hr style="margin: 20px 0; border: 0; border-top: 1px solid #eee;">

                        <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 10px;">
                            â–¶ï¸ Iniciar Entrevista Agora
                        </button>
                    </form>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2>ğŸ“ Respostas e AvaliaÃ§Ã£o</h2>
                        <div id="cronometro" class="cronometro hidden">â±ï¸ 00:00:00</div>
                    </div>
                    <div id="perguntasContainer" class="perguntas-container">
                        <div class="no-data">
                            Selecione um cargo para visualizar as perguntas da entrevista
                        </div>
                    </div>

                    <div class="avaliacao-section">
                        <h3>ğŸ“Š AvaliaÃ§Ã£o por CompetÃªncia</h3>
                        <div id="avaliacaoContainer">
                            <!-- AvaliaÃ§Ãµes carregadas dinamicamente -->
                        </div>

                        <div class="form-group">
                            <label for="pontosFortes">Pontos Fortes do Candidato</label>
                            <textarea id="pontosFortes"
                                placeholder="Liste os principais pontos positivos observados..."></textarea>
                        </div>

                        <div class="form-group">
                            <label for="pontosMelhorar">Pontos a Melhorar</label>
                            <textarea id="pontosMelhorar"
                                placeholder="Ãreas que precisam de desenvolvimento..."></textarea>
                        </div>

                        <div class="form-group">
                            <label for="observacoes">ObservaÃ§Ãµes Gerais</label>
                            <textarea id="observacoes"
                                placeholder="AnotaÃ§Ãµes adicionais sobre a entrevista..."></textarea>
                        </div>

                        <div class="form-group">
                            <label>AvaliaÃ§Ã£o Final</label>
                            <div class="radio-group">
                                <label class="radio-option">
                                    <input type="radio" name="status" value="aprovado">
                                    <span class="radio-label">âœ… Aprovado</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="status" value="reprovado">
                                    <span class="radio-label">âŒ Reprovado</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="status" value="analise" checked>
                                    <span class="radio-label">â³ Em AnÃ¡lise</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="status" value="faltou">
                                    <span class="radio-label">ğŸš« Faltou</span>
                                </label>
                            </div>
                        </div>

                        <button type="button" class="btn btn-success" onclick="salvarEntrevista()" style="width: 100%;">
                            ğŸ’¾ Salvar Entrevista Completa
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ABA: PAINEL DO DIA -->
        <div class="tab-content" id="tab-painel-dia">
            <div class="card">
                <div class="card-header" style="justify-content: space-between; align-items: center; display: flex;">
                    <h2>ğŸ“… Painel do Dia: <span id="dataPainelTitulo">--/--/----</span></h2>
                    <input type="date" id="dataFiltroPainel" class="btn-small"
                        style="padding: 5px; border-radius: 5px; border: 1px solid #ddd;">
                </div>
                <div class="painel-resumo-dia" id="painelResumoDia"
                    style="margin-bottom: 20px; display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                    <!-- Preenchido via JS -->
                </div>
                <div id="painelDiaContainer" class="agenda-container">
                    <!-- Entrevistas do dia carregadas via JS -->
                </div>
            </div>
        </div>

        <!-- ABA: AGENDA -->
        <div class="tab-content" id="tab-agenda">
            <div class="card">
                <div class="card-header">
                    <h2>ğŸ“… Agenda de Entrevistas</h2>
                </div>
                <div class="agenda-controls">
                    <button class="btn btn-small active" id="btnAgendaTriagem"
                        onclick="mudarVisualizacaoAgenda('triagem')">ğŸ“‹ Triagem Inicial</button>
                    <button class="btn btn-small btn-secondary" id="btnAgendaGerencia"
                        onclick="mudarVisualizacaoAgenda('gerencia')">ğŸ‘” Entrevista GerÃªncia</button>
                </div>
                <div id="agendaContainer" class="agenda-container">
                    <!-- Agenda carregada via JS -->
                </div>
            </div>
        </div>

        <!-- ABA: HISTÃ“RICO -->
        <div class="tab-content" id="tab-historico">
            <div class="card">
                <div class="card-header">
                    <h2>ğŸ“Š HistÃ³rico de Entrevistas</h2>
                    <div class="search-container">
                        <input type="text" id="buscarEntrevista" placeholder="ğŸ” Buscar por nome...">
                        <select id="filtroCargoHistorico">
                            <option value="">Todos os Cargos</option>
                        </select>
                        <input type="date" id="filtroDataInicio" title="Data Inicial">
                        <input type="date" id="filtroDataFim" title="Data Final">
                        <select id="filtroStatus">
                            <option value="">Todos status</option>
                            <option value="aprovado_triagem">Aprovados (Triagem)</option>
                            <option value="agendado_gerencia">Agendados (GerÃªncia)</option>
                            <option value="contratado">Contratados</option>
                            <option value="reprovado_gerencia">Reprovados (GerÃªncia)</option>
                            <option value="vaga_cancelada">Vaga Cancelada</option>
                            <option value="desistencia_candidato">DesistÃªncia Candidato</option>
                        </select>
                    </div>
                </div>

                <div class="entrevistas-lista" id="listaEntrevistas">
                    <!-- Entrevistas carregadas dinamicamente -->
                </div>
            </div>
        </div>

        <!-- ABA: RELATÃ“RIO PDF -->
        <div class="tab-content" id="tab-relatorio">
            <div class="card">
                <h2>ğŸ“„ Gerar RelatÃ³rio PDF</h2>

                <div class="form-group">
                    <label for="selecionarEntrevistaRelatorio">Selecionar Entrevista</label>
                    <select id="selecionarEntrevistaRelatorio">
                        <option value="">Escolha uma entrevista...</option>
                    </select>
                </div>

                <div id="relatorioPreview" class="relatorio-preview hidden">
                    <!-- Preview do relatÃ³rio -->
                </div>

                <div class="acoes-relatorio" id="acoesRelatorio">
                    <button class="btn btn-pdf" onclick="gerarPDF()" disabled>
                        ğŸ“¥ Gerar PDF
                    </button>
                    <button class="btn btn-secondary" onclick="imprimirRelatorio()" disabled>
                        ğŸ–¨ï¸ Imprimir
                    </button>
                </div>
            </div>
        </div>

        <!-- ABA: ESTATÃSTICAS -->
        <div class="tab-content" id="tab-estatisticas">
            <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2>ğŸ“ˆ EstatÃ­sticas e ConversÃ£o</h2>
                    <button class="btn btn-small btn-secondary" onclick="atualizarEstatisticas()">ğŸ”„ Atualizar</button>
                </div>

                <!-- GRÃFICO DE FUNIL -->
                <div class="funnel-container"
                    style="margin-bottom: 40px; padding: 20px; background: #fbfaff; border-radius: 15px; border: 1px dashed #dcd6f7;">
                    <h3 style="text-align: center; color: #6a0dad; margin-bottom: 20px;">ğŸŒªï¸ Funil de ConversÃ£o (Total)
                    </h3>
                    <div id="funnelChart" class="funnel-chart">
                        <!-- Renderizado via JS -->
                    </div>
                </div>

                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-icon">ğŸ“‹</div>
                        <div class="stat-number" id="totalEntrevistas">0</div>
                        <div class="stat-label">Total de Entrevistas</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">âœ…</div>
                        <div class="stat-number" id="totalAprovados">0</div>
                        <div class="stat-label">Aprovados</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">âŒ</div>
                        <div class="stat-number" id="totalReprovados">0</div>
                        <div class="stat-label">Reprovados</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">ğŸš«</div>
                        <div class="stat-number" id="totalFaltou">0</div>
                        <div class="stat-label">Faltou</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">ğŸ“Š</div>
                        <div class="stat-number" id="taxaAprovacao">0%</div>
                        <div class="stat-label">Taxa de AprovaÃ§Ã£o</div>
                    </div>
                </div>

                <div class="chart-container">
                    <h3>ğŸ“ˆ DistribuiÃ§Ã£o por Cargo</h3>
                    <div id="chartCargos" class="chart"></div>
                </div>

                <div class="chart-container">
                    <h3>ğŸ“… Entrevistas por MÃªs</h3>
                    <div id="chartMensal" class="chart"></div>
                </div>

                <div class="ultimas-entrevistas">
                    <h3>ğŸ• Ãšltimas Entrevistas</h3>
                    <div id="listaUltimasEntrevistas"></div>
                </div>
            </div>
        </div>

        <!-- ABA: CONFIGURAÃ‡Ã•ES (BACKUP) -->
        <div class="tab-content" id="tab-configuracoes">
            <div class="card">
                <h2>âš™ï¸ Gerenciamento de Dados</h2>
                <p>FaÃ§a o backup dos seus dados ou restaure de um arquivo salvo anteriormente.</p>

                <div class="backup-actions">
                    <div class="backup-card">
                        <h3>ğŸ“¤ Exportar Dados</h3>
                        <p>Baixe um arquivo JSON com todo o histÃ³rico de entrevistas.</p>
                        <button class="btn btn-primary" onclick="exportarDados()">Baixar Backup</button>
                    </div>

                    <div class="backup-card">
                        <h3>ğŸ“¥ Importar Dados</h3>
                        <p>Restaure entrevistas de um arquivo de backup (substitui ou mescla).</p>
                        <input type="file" id="arquivoBackup" accept=".json" style="margin-bottom: 10px;">
                        <button class="btn btn-secondary" onclick="importarDados()">Restaurar Backup</button>
                    </div>

                    <div class="backup-card"
                        style="border-top: 1px solid #eee; padding-top: 20px; grid-column: 1 / -1;">
                        <h3>ğŸ”„ SincronizaÃ§Ã£o Total (Nuvem + Local)</h3>
                        <p>Clique abaixo para unificar suas bases. O sistema garantirÃ¡ que tanto o seu computador quanto
                            a Planilha do Google tenham exatamente os mesmos dados atualizados.</p>
                        <button class="btn btn-primary" onclick="sincronizarComPlanilha()"
                            style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); width: 100%;">
                            ğŸ”„ Sincronizar Agora
                        </button>
                    </div>

                    <div class="backup-card"
                        style="border-top: 1px solid #eee; padding-top: 20px; grid-column: 1 / -1;">
                        <h3>ğŸ§¹ Limpeza de Testes</h3>
                        <p>Deseja remover todos os registros que tenham o nome "teste"?</p>
                        <button class="btn btn-danger" onclick="limparDadosTeste()" style="width: 100%;">
                            ğŸ§¹ Limpar Dados de "Teste"
                        </button>
                    </div>
                </div>

                <hr style="margin: 30px 0; border: 0; border-top: 1px solid #eee;">

                <div class="card-header">
                    <h2>ğŸ› ï¸ Editor de Cargos e Perguntas</h2>
                    <button class="btn btn-primary btn-small" onclick="abrirModalCargo()">â• Novo Cargo</button>
                </div>
                <div id="listaCargosConfig" class="lista-cargos-config">
                    <!-- Lista carregada via JS -->
                </div>
            </div>
        </div>

        <!-- MODAL DE DETALHES -->
        <div id="modalDetalhes" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Detalhes da Entrevista</h3>
                    <button class="close-modal" onclick="fecharModal()">&times;</button>
                </div>
                <div class="modal-body" id="modalDetalhesConteudo">
                    <!-- ConteÃºdo carregado dinamicamente -->
                </div>
            </div>
        </div>

        <!-- MODAL DE CONFIRMAÃ‡ÃƒO -->
        <div id="modalConfirmacao" class="modal">
            <div class="modal-content modal-sm">
                <div class="modal-body">
                    <p id="mensagemConfirmacao"></p>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="fecharModalConfirmacao()">Cancelar</button>
                    <button class="btn btn-danger" id="btnConfirmarAcao">Confirmar</button>
                </div>
            </div>
        </div>

        <!-- MODAL EDITOR DE CARGO -->
        <div id="modalEditorCargo" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="tituloModalCargo">Editar Cargo</h3>
                    <button class="close-modal" onclick="fecharModalCargo()">&times;</button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="editCargoId">
                    <div class="form-group">
                        <label>Nome do Cargo *</label>
                        <input type="text" id="editCargoNome" required placeholder="Ex: Vendedor LÃ­der">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Categoria</label>
                            <input type="text" id="editCargoCategoria" placeholder="Ex: Operacional">
                        </div>
                        <div class="form-group">
                            <label>DuraÃ§Ã£o Estimada</label>
                            <input type="text" id="editCargoDuracao" placeholder="Ex: 30-45 minutos">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>SalÃ¡rio</label>
                        <input type="text" id="editCargoSalario" placeholder="Ex: R$ 1.800,00">
                    </div>
                    <div class="form-group">
                        <label>HorÃ¡rio</label>
                        <input type="text" id="editCargoHorario" placeholder="Ex: Seg a Sex 09h Ã s 18h">
                    </div>
                    <div class="form-group">
                        <label>BenefÃ­cios (separados por vÃ­rgula)</label>
                        <input type="text" id="editCargoBeneficios" placeholder="VT, VR, Plano de SaÃºde">
                    </div>
                    <div class="form-group">
                        <label>ObservaÃ§Ãµes Internas (VisÃ­vel apenas para RH)</label>
                        <textarea id="editCargoObservacoes" rows="2"
                            placeholder="AnotaÃ§Ãµes sobre o perfil, dicas para o entrevistador..."></textarea>
                    </div>

                    <h4 style="margin: 20px 0 10px; color: #6a0dad; border-bottom: 1px solid #eee;">â“ Perguntas da
                        Entrevista</h4>
                    <div id="containerPerguntasEditor"
                        style="max-height: 300px; overflow-y: auto; margin-bottom: 15px; padding-right: 5px;">
                        <!-- Perguntas dinÃ¢micas -->
                    </div>
                    <button class="btn btn-secondary btn-small" onclick="adicionarPerguntaEditor()">â• Adicionar
                        Pergunta</button>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="fecharModalCargo()">Cancelar</button>
                    <button class="btn btn-primary" onclick="salvarCargoEditado()">ğŸ’¾ Salvar Cargo</button>
                </div>
            </div>
        </div>

        <!-- MODAL AGENDAMENTO GERÃŠNCIA -->
        <div id="modalAgendamentoGerencia" class="modal">
            <div class="modal-content modal-sm">
                <div class="modal-header">
                    <h3>ğŸ“… Agendar com GerÃªncia</h3>
                    <button class="close-modal" onclick="fecharModalGerencia()">&times;</button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="indexGerencia">
                    <div class="form-group">
                        <label>Candidato</label>
                        <input type="text" id="nomeCandidatoGerencia" disabled
                            style="background: #f0f0f0; color: #666;">
                    </div>
                    <div class="form-group">
                        <label>Data da Entrevista *</label>
                        <input type="date" id="dataGerencia" required>
                    </div>
                    <div class="form-group">
                        <label>Hora *</label>
                        <input type="time" id="horaGerencia" required>
                    </div>
                    <div class="form-group">
                        <label>Nome do Gerente *</label>
                        <input type="text" id="nomeGerente" placeholder="Quem farÃ¡ a entrevista?" required>
                    </div>
                    <div class="form-group">
                        <label>ObservaÃ§Ãµes para o Gerente</label>
                        <textarea id="obsGerencia" rows="3"
                            placeholder="Pontos de atenÃ§Ã£o ou foco da entrevista..."></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-primary" onclick="salvarAgendamentoGerencia()">Confirmar Agendamento</button>
                </div>
            </div>
        </div>

        <!-- MODAL RESULTADO GERÃŠNCIA -->
        <div id="modalResultadoGerencia" class="modal">
            <div class="modal-content modal-sm">
                <div class="modal-header">
                    <h3>ğŸ‘” Resultado Final (GerÃªncia)</h3>
                    <button class="close-modal" onclick="fecharModalResultadoGerencia()">&times;</button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="indexResultadoGerencia">
                    <p style="margin-bottom: 20px;">Defina o resultado da entrevista com a gerÃªncia para <strong
                            id="nomeCandidatoResultado" style="color: #8a2be2;"></strong>:</p>

                    <div style="display: flex; gap: 10px; flex-direction: column;">
                        <button class="btn btn-success" style="justify-content: center; padding: 15px;"
                            onclick="salvarResultadoGerencia('contratado')">
                            âœ… CONTRATAR CANDIDATO
                        </button>
                        <button class="btn btn-danger" style="justify-content: center; padding: 15px;"
                            onclick="salvarResultadoGerencia('reprovado_gerencia')">
                            âŒ REPROVAR NA GERÃŠNCIA
                        </button>

                        <button class="btn btn-secondary"
                            style="justify-content: center; padding: 12px; background: #e5e7eb; color: #4b5563; border: 1px solid #d1d5db;"
                            onclick="salvarResultadoGerencia('vaga_cancelada')">
                            ğŸš« VAGA CANCELADA
                        </button>

                        <button class="btn btn-secondary"
                            style="justify-content: center; padding: 12px; background: #f3f4f6; color: #6b7280; border: 1px dashed #9ca3af;"
                            onclick="salvarResultadoGerencia('desistencia_candidato')">
                            ğŸš¶ DESISTÃŠNCIA DO CANDIDATO
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="cargos.js"></script>
    <script src="script.js"></script>
</body>

</html>